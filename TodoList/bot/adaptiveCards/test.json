{
    "type": "AdaptiveCard",
    "body": [
        {
            "type": "Container",
            "style": "emphasis",
            "items": [
                {
                    "type": "ColumnSet",
                    "columns": [
                        {
                            "type": "Column",
                            "items": [
                                {
                                    "type": "TextBlock",
                                    "size": "Medium",
                                    "color": "Accent",
                                    "weight": "Bolder",
                                    "text": "*Keep early hours and enjoy yourself.*",
                                    "style": "heading"
                                }
                            ],
                            "width": "stretch"
                        }
                    ]
                }
            ],
            "bleed": true
        },
        {
            "type": "Container",
            "items": [
                {
                    "type": "ColumnSet",
                    "columns": [
                        {
                            "type": "Column",
                            "items": [
                                {
                                    "type": "TextBlock",
                                    "size": "ExtraLarge",
                                    "text": "**To-do List**",
                                    "wrap": true,
                                    "style": "heading"
                                }
                            ],
                            "width": "stretch"
                        }
                    ]
                }
            ]
        },
        {
            "type": "Container",
            "spacing": "Large",
            "style": "emphasis",
            "items": [
                {
                    "type": "ColumnSet",
                    "columns": [
                        {
                            "type": "Column",
                            "items": [
                                {
                                    "type": "TextBlock",
                                    "weight": "Bolder",
                                    "text": "DATE",
                                    "horizontalAlignment": "Left"
                                }
                            ],
                            "width": 8
                        },
                        {
                            "type": "Column",
                            "items": [
                                {
                                    "type": "TextBlock",
                                    "text": "STATUS",
                                    "horizontalAlignment": "Left",
                                    "weight": "Bolder"
                                }
                            ],
                            "spacing": "Small",
                            "width": 15
                        },
                        {
                            "type": "Column",
                            "items": [
                                {
                                    "type": "TextBlock",
                                    "weight": "Bolder",
                                    "text": "CONTENT",
                                    "horizontalAlignment": "Left",
                                    "spacing": "Large"
                                }
                            ],
                            "width": 60,
                            "spacing": "Small"
                        },
                        {
                            "type": "Column",
                            "items": [
                                {
                                    "type": "TextBlock",
                                    "weight": "Bolder",
                                    "text": "Participants",
                                    "horizontalAlignment": "Left"
                                }
                            ],
                            "width": 15
                        }
                    ]
                }
            ],
            "bleed": true
        },
        {
            "$data": "${tasks}",
            "type": "Container",
            "items": [
                {
                    "type": "ColumnSet",
                    "columns": [
                        {
                            "type": "Column",
                            "items": [
                                {
                                    "type": "TextBlock",
                                    "text": "${formatDateTime(taskTime, 'MM-dd')}",
                                    "wrap": true
                                }
                            ],
                            "width": 7
                        },
                        {
                            "type": "Column",
                            "items": [
                                {
                                    "type": "TextBlock",
                                    "text": "${taskStatus}",
                                    "wrap": true,
                                    "horizontalAlignment": "Left"
                                }
                            ],
                            "width": 13
                        },
                        {
                            "type": "Column",
                            "spacing": "Large",
                            "items": [
                                {
                                    "type": "TextBlock",
                                    "text": "${taskContent}",
                                    "wrap": true,
                                    "horizontalAlignment": "Left",
                                    "spacing": "None"
                                }
                            ],
                            "width": 60
                        },
                        {
                            "type": "Column",
                            "width": "auto",
                            "items": [
                                {
                                    "type": "Image",
                                    "style": "Person",
                                    "url": "${participants[0].profileImage}",
                                    "width": "40px"
                                }
                            ],
                            "spacing": "Small",
                            "verticalContentAlignment": "Center"
                        },
                        {
                            "type": "Column",
                            "spacing": "Small",
                            "selectAction": {
                                "type": "Action.ToggleVisibility",
                                "title": "expand",
                                "targetElements": [
                                    "cardContent${$index}",
                                    "chevronDown${$index}",
                                    "chevronUp${$index}"
                                ]
                            },
                            "verticalContentAlignment": "Center",
                            "items": [
                                {
                                    "type": "Image",
                                    "id": "chevronDown${$index}",
                                    "url": "https://adaptivecards.io/content/down.png",
                                    "width": "20px",
                                    "altText": "Details collapsed"
                                },
                                {
                                    "type": "Image",
                                    "id": "chevronUp${$index}",
                                    "url": "https://adaptivecards.io/content/up.png",
                                    "width": "20px",
                                    "altText": "Details expanded",
                                    "isVisible": false
                                }
                            ],
                            "width": "auto"
                        },
                        {
                            "type": "Column",
                            "spacing": "Small",
                            "verticalContentAlignment": "Center",
                            "items": [
                                {
                                    "type": "Image",
                                    "url": "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOTYiIGhlaWdodD0iOTYiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHhtbDpzcGFjZT0icHJlc2VydmUiIG92ZXJmbG93PSJoaWRkZW4iPjxkZWZzPjxjbGlwUGF0aCBpZD0iY2xpcDAiPjxyZWN0IHg9IjY0MCIgeT0iMzM5IiB3aWR0aD0iOTYiIGhlaWdodD0iOTYiLz48L2NsaXBQYXRoPjwvZGVmcz48ZyBjbGlwLXBhdGg9InVybCgjY2xpcDApIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtNjQwIC0zMzkpIj48cGF0aCBkPSJNNzE4IDM1OSA3MDEgMzU5IDcwMSAzNTRDNzAxIDM1MC4xIDY5Ny45IDM0NyA2OTQgMzQ3TDY4MiAzNDdDNjc4LjEgMzQ3IDY3NSAzNTAuMSA2NzUgMzU0TDY3NSAzNTkgNjU4IDM1OUM2NTUuOCAzNTkgNjU0IDM2MC44IDY1NCAzNjNMNjU0IDM2NyA3MjIgMzY3IDcyMiAzNjNDNzIyIDM2MC44IDcyMC4yIDM1OSA3MTggMzU5Wk02ODEgMzU0QzY4MSAzNTMuNCA2ODEuNCAzNTMgNjgyIDM1M0w2OTQgMzUzQzY5NC42IDM1MyA2OTUgMzUzLjQgNjk1IDM1NEw2OTUgMzU5IDY4MSAzNTkgNjgxIDM1NFoiIGZpbGw9IiNBRkFCQUIiLz48cGF0aCBkPSJNNjYwIDQyM0M2NjAgNDI1LjIgNjYxLjggNDI3IDY2NCA0MjdMNzEyIDQyN0M3MTQuMiA0MjcgNzE2IDQyNS4yIDcxNiA0MjNMNzE2IDM3MSA2NjAgMzcxIDY2MCA0MjNaTTcwMSAzNzcgNzA3IDM3NyA3MDcgNDIxIDcwMSA0MjEgNzAxIDM3N1pNNjg1IDM3NyA2OTEgMzc3IDY5MSA0MjEgNjg1IDQyMSA2ODUgMzc3Wk02NjkgMzc3IDY3NSAzNzcgNjc1IDQyMSA2NjkgNDIxIDY2OSAzNzdaIiBmaWxsPSIjQUZBQkFCIi8+PC9nPjwvc3ZnPg==",
                                    "width": "20px"
                                }
                            ],
                            "selectAction": {
                                "type": "Action.Submit",
                                "data": {
                                    "action": "del"
                                }
                            },
                            "width": 3
                        }
                    ]
                },
                {
                    "type": "Container",
                    "id": "cardContent${$index}",
                    "isVisible": false,
                    "items": [
                        {
                            "type": "Container",
                            "items": [
                                {
                                    "type": "TextBlock",
                                    "text": "- Modify the above to-do item",
                                    "isSubtle": true,
                                    "wrap": true,
                                    "horizontalAlignment": "Left"
                                },
                                {
                                    "type": "Container",
                                    "items": [
                                        {
                                            "type": "ColumnSet",
                                            "columns": [
                                                {
                                                    "type": "Column",
                                                    "items": [
                                                        {
                                                            "type": "Input.Date",
                                                            "id": "updateTime${$index}",
                                                            "value": "${formatDateTime(taskTime, 'YYYY-MM-dd')}"
                                                        }
                                                    ],
                                                    "width": 50
                                                },
                                                {
                                                    "type": "Column",
                                                    "items": [
                                                        {
                                                            "type": "Input.ChoiceSet",
                                                            "id": "updateStatus${$index}",
                                                            "choices": [
                                                                {
                                                                    "title": "Not started",
                                                                    "value": "Not started"
                                                                },
                                                                {
                                                                    "title": "Processing",
                                                                    "value": "Processing"
                                                                },
                                                                {
                                                                    "title": "Finished",
                                                                    "value": "Finished"
                                                                }
                                                            ],
                                                            "placeholder": "${taskStatus}"
                                                        }
                                                    ],
                                                    "width": 50
                                                }
                                            ]
                                        },
                                        {
                                            "type": "Input.Text",
                                            "id": "updateParticipant${$index}",
                                            "value": "${creator.userName}"
                                        },
                                        {
                                            "type": "Input.Text",
                                            "id": "updateContent${$index}",
                                            "isMultiline": true,
                                            "placeholder": "${taskContent}",
                                            "value": "${taskContent}"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "Container",
                            "items": [
                                {
                                    "type": "ColumnSet",
                                    "columns": [
                                        {
                                            "type": "Column",
                                            "items": [
                                                {
                                                    "type": "ActionSet",
                                                    "actions": [
                                                        {
                                                            "type": "Action.Submit",
                                                            "title": "Confirm",
                                                            "data": {
                                                                "id": "edit",
                                                                "action": "edit",
                                                                "lineItem": 1
                                                            }
                                                        }
                                                    ]
                                                }
                                            ],
                                            "width": "auto"
                                        }
                                    ],
                                    "minHeight": "0px"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "type": "Container",
            "spacing": "Large",
            "items": [
                {
                    "type": "ActionSet",
                    "actions": [
                        {
                            "type": "Action.ShowCard",
                            "title": "New Item",
                            "card": {
                                "type": "AdaptiveCard",
                                "actions": [
                                    {
                                        "type": "Action.Submit",
                                        "title": "Confirm",
                                        "data": {
                                            "id": ""
                                        }
                                    }
                                ],
                                "$schema": "http://adaptivecards.io/schemas/adaptive-card.json",
                                "body": [
                                    {
                                        "type": "Input.Date",
                                        "id": "addDate",
                                        "label": "Date",
                                        "value": "${formatDateTime(enquiredDate, 'YYYY-MM-dd')}",
                                        "isRequired": true
                                    },
                                    {
                                        "type": "Input.Text",
                                        "id": "addParticipants",
                                        "label": "Participants"
                                    },
                                    {
                                        "type": "Input.Text",
                                        "placeholder": "What will you do?",
                                        "id": "addContent",
                                        "label": "Content",
                                        "isMultiline": true,
                                        "isRequired": true
                                    }
                                ]
                            },
                            "style": "positive"
                        }
                    ]
                }
            ]
        }
    ],
    "$schema": "http://adaptivecards.io/schemas/adaptive-card.json",
    "version": "1.4",
    "fallbackText": "This card requires Adaptive Cards v1.2 support to be rendered properly."
}